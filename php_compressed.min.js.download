!function(e,P){"function"==typeof define&&define.amd?define(["./blockly_compressed.js"],P):"object"==typeof exports?module.exports=P(require("./blockly_compressed.js")):e.Blockly.PHP=P(e.Blockly)}(this,function(O){"use strict";return O.PHP=new O.Generator("PHP"),O.PHP.addReservedWords("__halt_compiler,abstract,and,array,as,break,callable,case,catch,class,clone,const,continue,declare,default,die,do,echo,else,elseif,empty,enddeclare,endfor,endforeach,endif,endswitch,endwhile,eval,exit,extends,final,for,foreach,function,global,goto,if,implements,include,include_once,instanceof,insteadof,interface,isset,list,namespace,new,or,print,private,protected,public,require,require_once,return,static,switch,throw,trait,try,unset,use,var,while,xor,PHP_VERSION,PHP_MAJOR_VERSION,PHP_MINOR_VERSION,PHP_RELEASE_VERSION,PHP_VERSION_ID,PHP_EXTRA_VERSION,PHP_ZTS,PHP_DEBUG,PHP_MAXPATHLEN,PHP_OS,PHP_SAPI,PHP_EOL,PHP_INT_MAX,PHP_INT_SIZE,DEFAULT_INCLUDE_PATH,PEAR_INSTALL_DIR,PEAR_EXTENSION_DIR,PHP_EXTENSION_DIR,PHP_PREFIX,PHP_BINDIR,PHP_BINARY,PHP_MANDIR,PHP_LIBDIR,PHP_DATADIR,PHP_SYSCONFDIR,PHP_LOCALSTATEDIR,PHP_CONFIG_FILE_PATH,PHP_CONFIG_FILE_SCAN_DIR,PHP_SHLIB_SUFFIX,E_ERROR,E_WARNING,E_PARSE,E_NOTICE,E_CORE_ERROR,E_CORE_WARNING,E_COMPILE_ERROR,E_COMPILE_WARNING,E_USER_ERROR,E_USER_WARNING,E_USER_NOTICE,E_DEPRECATED,E_USER_DEPRECATED,E_ALL,E_STRICT,__COMPILER_HALT_OFFSET__,TRUE,FALSE,NULL,__CLASS__,__DIR__,__FILE__,__FUNCTION__,__LINE__,__METHOD__,__NAMESPACE__,__TRAIT__"),O.PHP.ORDER_ATOMIC=0,O.PHP.ORDER_CLONE=1,O.PHP.ORDER_NEW=1,O.PHP.ORDER_MEMBER=2.1,O.PHP.ORDER_FUNCTION_CALL=2.2,O.PHP.ORDER_POWER=3,O.PHP.ORDER_INCREMENT=4,O.PHP.ORDER_DECREMENT=4,O.PHP.ORDER_BITWISE_NOT=4,O.PHP.ORDER_CAST=4,O.PHP.ORDER_SUPPRESS_ERROR=4,O.PHP.ORDER_INSTANCEOF=5,O.PHP.ORDER_LOGICAL_NOT=6,O.PHP.ORDER_UNARY_PLUS=7.1,O.PHP.ORDER_UNARY_NEGATION=7.2,O.PHP.ORDER_MULTIPLICATION=8.1,O.PHP.ORDER_DIVISION=8.2,O.PHP.ORDER_MODULUS=8.3,O.PHP.ORDER_ADDITION=9.1,O.PHP.ORDER_SUBTRACTION=9.2,O.PHP.ORDER_STRING_CONCAT=9.3,O.PHP.ORDER_BITWISE_SHIFT=10,O.PHP.ORDER_RELATIONAL=11,O.PHP.ORDER_EQUALITY=12,O.PHP.ORDER_REFERENCE=13,O.PHP.ORDER_BITWISE_AND=13,O.PHP.ORDER_BITWISE_XOR=14,O.PHP.ORDER_BITWISE_OR=15,O.PHP.ORDER_LOGICAL_AND=16,O.PHP.ORDER_LOGICAL_OR=17,O.PHP.ORDER_IF_NULL=18,O.PHP.ORDER_CONDITIONAL=19,O.PHP.ORDER_ASSIGNMENT=20,O.PHP.ORDER_LOGICAL_AND_WEAK=21,O.PHP.ORDER_LOGICAL_XOR=22,O.PHP.ORDER_LOGICAL_OR_WEAK=23,O.PHP.ORDER_COMMA=24,O.PHP.ORDER_NONE=99,O.PHP.ORDER_OVERRIDES=[[O.PHP.ORDER_MEMBER,O.PHP.ORDER_FUNCTION_CALL],[O.PHP.ORDER_MEMBER,O.PHP.ORDER_MEMBER],[O.PHP.ORDER_LOGICAL_NOT,O.PHP.ORDER_LOGICAL_NOT],[O.PHP.ORDER_MULTIPLICATION,O.PHP.ORDER_MULTIPLICATION],[O.PHP.ORDER_ADDITION,O.PHP.ORDER_ADDITION],[O.PHP.ORDER_LOGICAL_AND,O.PHP.ORDER_LOGICAL_AND],[O.PHP.ORDER_LOGICAL_OR,O.PHP.ORDER_LOGICAL_OR]],O.PHP.init=function(e){O.PHP.definitions_=Object.create(null),O.PHP.functionNames_=Object.create(null),O.PHP.variableDB_?O.PHP.variableDB_.reset():O.PHP.variableDB_=new O.Names(O.PHP.RESERVED_WORDS_,"$"),O.PHP.variableDB_.setVariableMap(e.getVariableMap());for(var P=[],t=O.Variables.allDeveloperVariables(e),r=0;r<t.length;r++)P.push(O.PHP.variableDB_.getName(t[r],O.Names.DEVELOPER_VARIABLE_TYPE)+";");for(e=O.Variables.allUsedVarModels(e),r=0;t=e[r];r++)P.push(O.PHP.variableDB_.getName(t.getId(),O.VARIABLE_CATEGORY_NAME)+";");O.PHP.definitions_.variables=P.join("\n")},O.PHP.finish=function(e){var P,t=[];for(P in O.PHP.definitions_)t.push(O.PHP.definitions_[P]);return delete O.PHP.definitions_,delete O.PHP.functionNames_,O.PHP.variableDB_.reset(),t.join("\n\n")+"\n\n\n"+e},O.PHP.scrubNakedValue=function(e){return e+";\n"},O.PHP.quote_=function(e){return"'"+(e=e.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n").replace(/'/g,"\\'"))+"'"},O.PHP.multiline_quote_=function(e){return"<<<EOT\n"+e+"\nEOT"},O.PHP.scrub_=function(e,P,t){var r="";if(!e.outputConnection||!e.outputConnection.targetConnection){var n=e.getCommentText();n&&(n=O.utils.string.wrap(n,O.PHP.COMMENT_WRAP-3),r+=O.PHP.prefixLines(n,"// ")+"\n");for(var _=0;_<e.inputList.length;_++)e.inputList[_].type==O.INPUT_VALUE&&(n=e.inputList[_].connection.targetBlock())&&(n=O.PHP.allNestedComments(n))&&(r+=O.PHP.prefixLines(n,"// "))}return e=e.nextConnection&&e.nextConnection.targetBlock(),r+P+(t=t?"":O.PHP.blockToCode(e))},O.PHP.getAdjusted=function(e,P,t,r,n){t=t||0,n=n||O.PHP.ORDER_NONE,e.workspace.options.oneBasedIndex&&t--;var _,a=e.workspace.options.oneBasedIndex?"1":"0";return e=0<t?O.PHP.valueToCode(e,P,O.PHP.ORDER_ADDITION)||a:t<0?O.PHP.valueToCode(e,P,O.PHP.ORDER_SUBTRACTION)||a:r?O.PHP.valueToCode(e,P,O.PHP.ORDER_UNARY_NEGATION)||a:O.PHP.valueToCode(e,P,n)||a,O.isNumber(e)?(e=Number(e)+t,r&&(e=-e)):(0<t?(e=e+" + "+t,_=O.PHP.ORDER_ADDITION):t<0&&(e=e+" - "+-t,_=O.PHP.ORDER_SUBTRACTION),r&&(e=t?"-("+e+")":"-"+e,_=O.PHP.ORDER_UNARY_NEGATION),_=Math.floor(_),n=Math.floor(n),_&&_<=n&&(e="("+e+")")),e},O.PHP.colour={},O.PHP.colour_picker=function(e){return[O.PHP.quote_(e.getFieldValue("COLOUR")),O.PHP.ORDER_ATOMIC]},O.PHP.colour_random=function(e){return[O.PHP.provideFunction_("colour_random",["function "+O.PHP.FUNCTION_NAME_PLACEHOLDER_+"() {","  return '#' . str_pad(dechex(mt_rand(0, 0xFFFFFF)), 6, '0', STR_PAD_LEFT);","}"])+"()",O.PHP.ORDER_FUNCTION_CALL]},O.PHP.colour_rgb=function(e){var P=O.PHP.valueToCode(e,"RED",O.PHP.ORDER_COMMA)||0,t=O.PHP.valueToCode(e,"GREEN",O.PHP.ORDER_COMMA)||0;return e=O.PHP.valueToCode(e,"BLUE",O.PHP.ORDER_COMMA)||0,[O.PHP.provideFunction_("colour_rgb",["function "+O.PHP.FUNCTION_NAME_PLACEHOLDER_+"($r, $g, $b) {","  $r = round(max(min($r, 100), 0) * 2.55);","  $g = round(max(min($g, 100), 0) * 2.55);","  $b = round(max(min($b, 100), 0) * 2.55);","  $hex = '#';","  $hex .= str_pad(dechex($r), 2, '0', STR_PAD_LEFT);","  $hex .= str_pad(dechex($g), 2, '0', STR_PAD_LEFT);","  $hex .= str_pad(dechex($b), 2, '0', STR_PAD_LEFT);","  return $hex;","}"])+"("+P+", "+t+", "+e+")",O.PHP.ORDER_FUNCTION_CALL]},O.PHP.colour_blend=function(e){var P=O.PHP.valueToCode(e,"COLOUR1",O.PHP.ORDER_COMMA)||"'#000000'",t=O.PHP.valueToCode(e,"COLOUR2",O.PHP.ORDER_COMMA)||"'#000000'";return e=O.PHP.valueToCode(e,"RATIO",O.PHP.ORDER_COMMA)||.5,[O.PHP.provideFunction_("colour_blend",["function "+O.PHP.FUNCTION_NAME_PLACEHOLDER_+"($c1, $c2, $ratio) {","  $ratio = max(min($ratio, 1), 0);","  $r1 = hexdec(substr($c1, 1, 2));","  $g1 = hexdec(substr($c1, 3, 2));","  $b1 = hexdec(substr($c1, 5, 2));","  $r2 = hexdec(substr($c2, 1, 2));","  $g2 = hexdec(substr($c2, 3, 2));","  $b2 = hexdec(substr($c2, 5, 2));","  $r = round($r1 * (1 - $ratio) + $r2 * $ratio);","  $g = round($g1 * (1 - $ratio) + $g2 * $ratio);","  $b = round($b1 * (1 - $ratio) + $b2 * $ratio);","  $hex = '#';","  $hex .= str_pad(dechex($r), 2, '0', STR_PAD_LEFT);","  $hex .= str_pad(dechex($g), 2, '0', STR_PAD_LEFT);","  $hex .= str_pad(dechex($b), 2, '0', STR_PAD_LEFT);","  return $hex;","}"])+"("+P+", "+t+", "+e+")",O.PHP.ORDER_FUNCTION_CALL]},O.PHP.lists={},O.PHP.lists_create_empty=function(e){return["array()",O.PHP.ORDER_FUNCTION_CALL]},O.PHP.lists_create_with=function(e){for(var P=Array(e.itemCount_),t=0;t<e.itemCount_;t++)P[t]=O.PHP.valueToCode(e,"ADD"+t,O.PHP.ORDER_COMMA)||"null";return[P="array("+P.join(", ")+")",O.PHP.ORDER_FUNCTION_CALL]},O.PHP.lists_repeat=function(e){return[O.PHP.provideFunction_("lists_repeat",["function "+O.PHP.FUNCTION_NAME_PLACEHOLDER_+"($value, $count) {","  $array = array();","  for ($index = 0; $index < $count; $index++) {","    $array[] = $value;","  }","  return $array;","}"])+"("+(O.PHP.valueToCode(e,"ITEM",O.PHP.ORDER_COMMA)||"null")+", "+(e=O.PHP.valueToCode(e,"NUM",O.PHP.ORDER_COMMA)||"0")+")",O.PHP.ORDER_FUNCTION_CALL]},O.PHP.lists_length=function(e){return[O.PHP.provideFunction_("length",["function "+O.PHP.FUNCTION_NAME_PLACEHOLDER_+"($value) {","  if (is_string($value)) {","    return strlen($value);","  } else {","    return count($value);","  }","}"])+"("+(e=O.PHP.valueToCode(e,"VALUE",O.PHP.ORDER_NONE)||"''")+")",O.PHP.ORDER_FUNCTION_CALL]},O.PHP.lists_isEmpty=function(e){return["empty("+(O.PHP.valueToCode(e,"VALUE",O.PHP.ORDER_FUNCTION_CALL)||"array()")+")",O.PHP.ORDER_FUNCTION_CALL]},O.PHP.lists_indexOf=function(e){var P,t=O.PHP.valueToCode(e,"FIND",O.PHP.ORDER_NONE)||"''",r=O.PHP.valueToCode(e,"VALUE",O.PHP.ORDER_MEMBER)||"[]",n=e.workspace.options.oneBasedIndex?(P=" 0"," + 1"):(P=" -1","");return[("FIRST"==e.getFieldValue("END")?O.PHP.provideFunction_("indexOf",["function "+O.PHP.FUNCTION_NAME_PLACEHOLDER_+"($haystack, $needle) {","  for ($index = 0; $index < count($haystack); $index++) {","    if ($haystack[$index] == $needle) return $index"+n+";","  }","  return "+P+";","}"]):O.PHP.provideFunction_("lastIndexOf",["function "+O.PHP.FUNCTION_NAME_PLACEHOLDER_+"($haystack, $needle) {","  $last = "+P+";","  for ($index = 0; $index < count($haystack); $index++) {","    if ($haystack[$index] == $needle) $last = $index"+n+";","  }","  return $last;","}"]))+"("+r+", "+t+")",O.PHP.ORDER_FUNCTION_CALL]},O.PHP.lists_getIndex=function(e){var P=e.getFieldValue("MODE")||"GET";switch(e.getFieldValue("WHERE")||"FROM_START"){case"FIRST":if("GET"==P){var t=O.PHP.valueToCode(e,"VALUE",O.PHP.ORDER_MEMBER)||"array()";return[t+"[0]",O.PHP.ORDER_MEMBER]}if("GET_REMOVE"==P)return["array_shift("+(t=O.PHP.valueToCode(e,"VALUE",O.PHP.ORDER_NONE)||"array()")+")",O.PHP.ORDER_FUNCTION_CALL];if("REMOVE"==P)return"array_shift("+(t=O.PHP.valueToCode(e,"VALUE",O.PHP.ORDER_NONE)||"array()")+");\n";break;case"LAST":if("GET"==P)return["end("+(t=O.PHP.valueToCode(e,"VALUE",O.PHP.ORDER_NONE)||"array()")+")",O.PHP.ORDER_FUNCTION_CALL];if("GET_REMOVE"==P)return["array_pop("+(t=O.PHP.valueToCode(e,"VALUE",O.PHP.ORDER_NONE)||"array()")+")",O.PHP.ORDER_FUNCTION_CALL];if("REMOVE"==P)return"array_pop("+(t=O.PHP.valueToCode(e,"VALUE",O.PHP.ORDER_NONE)||"array()")+");\n";break;case"FROM_START":var r=O.PHP.getAdjusted(e,"AT");if("GET"==P)return[(t=O.PHP.valueToCode(e,"VALUE",O.PHP.ORDER_MEMBER)||"array()")+"["+r+"]",O.PHP.ORDER_MEMBER];if("GET_REMOVE"==P)return["array_splice("+(t=O.PHP.valueToCode(e,"VALUE",O.PHP.ORDER_COMMA)||"array()")+", "+r+", 1)[0]",O.PHP.ORDER_FUNCTION_CALL];if("REMOVE"==P)return"array_splice("+(t=O.PHP.valueToCode(e,"VALUE",O.PHP.ORDER_COMMA)||"array()")+", "+r+", 1);\n";break;case"FROM_END":if("GET"==P)return["array_slice("+(t=O.PHP.valueToCode(e,"VALUE",O.PHP.ORDER_COMMA)||"array()")+", "+(r=O.PHP.getAdjusted(e,"AT",1,!0))+", 1)[0]",O.PHP.ORDER_FUNCTION_CALL];if("GET_REMOVE"==P||"REMOVE"==P){if(t="array_splice("+(t=O.PHP.valueToCode(e,"VALUE",O.PHP.ORDER_NONE)||"array()")+", count("+t+") - "+(r=O.PHP.getAdjusted(e,"AT",1,!1,O.PHP.ORDER_SUBTRACTION))+", 1)[0]","GET_REMOVE"==P)return[t,O.PHP.ORDER_FUNCTION_CALL];if("REMOVE"==P)return t+";\n"}break;case"RANDOM":if(t=O.PHP.valueToCode(e,"VALUE",O.PHP.ORDER_NONE)||"array()","GET"==P)return[(P=O.PHP.provideFunction_("lists_get_random_item",["function "+O.PHP.FUNCTION_NAME_PLACEHOLDER_+"($list) {","  return $list[rand(0,count($list)-1)];","}"]))+"("+t+")",O.PHP.ORDER_FUNCTION_CALL];if("GET_REMOVE"==P)return[(P=O.PHP.provideFunction_("lists_get_remove_random_item",["function "+O.PHP.FUNCTION_NAME_PLACEHOLDER_+"(&$list) {","  $x = rand(0,count($list)-1);","  unset($list[$x]);","  return array_values($list);","}"]))+"("+t+")",O.PHP.ORDER_FUNCTION_CALL];if("REMOVE"==P)return(P=O.PHP.provideFunction_("lists_remove_random_item",["function "+O.PHP.FUNCTION_NAME_PLACEHOLDER_+"(&$list) {","  unset($list[rand(0,count($list)-1)]);","}"]))+"("+t+");\n"}throw Error("Unhandled combination (lists_getIndex).")},O.PHP.lists_setIndex=function(e){var P=e.getFieldValue("MODE")||"GET",t=e.getFieldValue("WHERE")||"FROM_START",r=O.PHP.valueToCode(e,"TO",O.PHP.ORDER_ASSIGNMENT)||"null";switch(t){case"FIRST":if("SET"==P)return(t=O.PHP.valueToCode(e,"LIST",O.PHP.ORDER_MEMBER)||"array()")+"[0] = "+r+";\n";if("INSERT"==P)return"array_unshift("+(t=O.PHP.valueToCode(e,"LIST",O.PHP.ORDER_COMMA)||"array()")+", "+r+");\n";break;case"LAST":if(t=O.PHP.valueToCode(e,"LIST",O.PHP.ORDER_COMMA)||"array()","SET"==P)return(P=O.PHP.provideFunction_("lists_set_last_item",["function "+O.PHP.FUNCTION_NAME_PLACEHOLDER_+"(&$list, $value) {","  $list[count($list) - 1] = $value;","}"]))+"("+t+", "+r+");\n";if("INSERT"==P)return"array_push("+t+", "+r+");\n";break;case"FROM_START":var n=O.PHP.getAdjusted(e,"AT");if("SET"==P)return(t=O.PHP.valueToCode(e,"LIST",O.PHP.ORDER_MEMBER)||"array()")+"["+n+"] = "+r+";\n";if("INSERT"==P)return"array_splice("+(t=O.PHP.valueToCode(e,"LIST",O.PHP.ORDER_COMMA)||"array()")+", "+n+", 0, "+r+");\n";break;case"FROM_END":if(t=O.PHP.valueToCode(e,"LIST",O.PHP.ORDER_COMMA)||"array()",n=O.PHP.getAdjusted(e,"AT",1),"SET"==P)return(P=O.PHP.provideFunction_("lists_set_from_end",["function "+O.PHP.FUNCTION_NAME_PLACEHOLDER_+"(&$list, $at, $value) {","  $list[count($list) - $at] = $value;","}"]))+"("+t+", "+n+", "+r+");\n";if("INSERT"==P)return(P=O.PHP.provideFunction_("lists_insert_from_end",["function "+O.PHP.FUNCTION_NAME_PLACEHOLDER_+"(&$list, $at, $value) {","  return array_splice($list, count($list) - $at, 0, $value);","}"]))+"("+t+", "+n+", "+r+");\n";break;case"RANDOM":if(e=(t=O.PHP.valueToCode(e,"LIST",O.PHP.ORDER_REFERENCE)||"array()").match(/^\$\w+$/)?"":(n=(e=O.PHP.variableDB_.getDistinctName("tmp_list",O.VARIABLE_CATEGORY_NAME))+" = &"+t+";\n",t=e,n),e+=(n=O.PHP.variableDB_.getDistinctName("tmp_x",O.VARIABLE_CATEGORY_NAME))+" = rand(0, count("+t+")-1);\n","SET"==P)return e+(t+"[")+n+"] = "+r+";\n";if("INSERT"==P)return e+"array_splice("+t+", "+n+", 0, "+r+");\n"}throw Error("Unhandled combination (lists_setIndex).")},O.PHP.lists_getSublist=function(e){var P=O.PHP.valueToCode(e,"LIST",O.PHP.ORDER_COMMA)||"array()",t=e.getFieldValue("WHERE1"),r=e.getFieldValue("WHERE2");if("FIRST"!=t||"LAST"!=r)if(P.match(/^\$\w+$/)||"FROM_END"!=t&&"FROM_START"==r){switch(t){case"FROM_START":var n=O.PHP.getAdjusted(e,"AT1");break;case"FROM_END":n="count("+P+") - "+(n=O.PHP.getAdjusted(e,"AT1",1,!1,O.PHP.ORDER_SUBTRACTION));break;case"FIRST":n="0";break;default:throw Error("Unhandled option (lists_getSublist).")}switch(r){case"FROM_START":t=(e=O.PHP.getAdjusted(e,"AT2",0,!1,O.PHP.ORDER_SUBTRACTION))+" - ",t=O.isNumber(String(n))||String(n).match(/^\(.+\)$/)?t+n:t+"("+n+")",t+=" + 1";break;case"FROM_END":t="count("+P+") - "+(e=O.PHP.getAdjusted(e,"AT2",0,!1,O.PHP.ORDER_SUBTRACTION))+" - ",t=O.isNumber(String(n))||String(n).match(/^\(.+\)$/)?t+n:t+"("+n+")";break;case"LAST":t="count("+P+") - ",t=O.isNumber(String(n))||String(n).match(/^\(.+\)$/)?t+n:t+"("+n+")";break;default:throw Error("Unhandled option (lists_getSublist).")}P="array_slice("+P+", "+n+", "+t+")"}else n=O.PHP.getAdjusted(e,"AT1"),e=O.PHP.getAdjusted(e,"AT2"),P=O.PHP.provideFunction_("lists_get_sublist",["function "+O.PHP.FUNCTION_NAME_PLACEHOLDER_+"($list, $where1, $at1, $where2, $at2) {","  if ($where1 == 'FROM_END') {","    $at1 = count($list) - 1 - $at1;","  } else if ($where1 == 'FIRST') {","    $at1 = 0;","  } else if ($where1 != 'FROM_START') {","    throw new Exception('Unhandled option (lists_get_sublist).');","  }","  $length = 0;","  if ($where2 == 'FROM_START') {","    $length = $at2 - $at1 + 1;","  } else if ($where2 == 'FROM_END') {","    $length = count($list) - $at1 - $at2;","  } else if ($where2 == 'LAST') {","    $length = count($list) - $at1;","  } else {","    throw new Exception('Unhandled option (lists_get_sublist).');","  }","  return array_slice($list, $at1, $length);","}"])+"("+P+", '"+t+"', "+n+", '"+r+"', "+e+")";return[P,O.PHP.ORDER_FUNCTION_CALL]},O.PHP.lists_sort=function(e){var P=O.PHP.valueToCode(e,"LIST",O.PHP.ORDER_COMMA)||"array()",t="1"===e.getFieldValue("DIRECTION")?1:-1;return e=e.getFieldValue("TYPE"),[O.PHP.provideFunction_("lists_sort",["function "+O.PHP.FUNCTION_NAME_PLACEHOLDER_+"($list, $type, $direction) {","  $sortCmpFuncs = array(",'    "NUMERIC" => "strnatcasecmp",','    "TEXT" => "strcmp",','    "IGNORE_CASE" => "strcasecmp"',"  );","  $sortCmp = $sortCmpFuncs[$type];","  $list2 = $list;","  usort($list2, $sortCmp);","  if ($direction == -1) {","    $list2 = array_reverse($list2);","  }","  return $list2;","}"])+"("+P+', "'+e+'", '+t+")",O.PHP.ORDER_FUNCTION_CALL]},O.PHP.lists_split=function(e){var P=O.PHP.valueToCode(e,"INPUT",O.PHP.ORDER_COMMA),t=O.PHP.valueToCode(e,"DELIM",O.PHP.ORDER_COMMA)||"''";if("SPLIT"==(e=e.getFieldValue("MODE")))P=P||"''",e="explode";else{if("JOIN"!=e)throw Error("Unknown mode: "+e);P=P||"array()",e="implode"}return[e+"("+t+", "+P+")",O.PHP.ORDER_FUNCTION_CALL]},O.PHP.lists_reverse=function(e){return["array_reverse("+(O.PHP.valueToCode(e,"LIST",O.PHP.ORDER_COMMA)||"[]")+")",O.PHP.ORDER_FUNCTION_CALL]},O.PHP.logic={},O.PHP.controls_if=function(e){var P=0,t="";O.PHP.STATEMENT_PREFIX&&(t+=O.PHP.injectId(O.PHP.STATEMENT_PREFIX,e));do{var r=O.PHP.valueToCode(e,"IF"+P,O.PHP.ORDER_NONE)||"false",n=O.PHP.statementToCode(e,"DO"+P);O.PHP.STATEMENT_SUFFIX&&(n=O.PHP.prefixLines(O.PHP.injectId(O.PHP.STATEMENT_SUFFIX,e),O.PHP.INDENT)+n),t+=(0<P?" else ":"")+"if ("+r+") {\n"+n+"}",++P}while(e.getInput("IF"+P));return(e.getInput("ELSE")||O.PHP.STATEMENT_SUFFIX)&&(n=O.PHP.statementToCode(e,"ELSE"),O.PHP.STATEMENT_SUFFIX&&(n=O.PHP.prefixLines(O.PHP.injectId(O.PHP.STATEMENT_SUFFIX,e),O.PHP.INDENT)+n),t+=" else {\n"+n+"}"),t+"\n"},O.PHP.controls_ifelse=O.PHP.controls_if,O.PHP.logic_compare=function(e){var P={EQ:"==",NEQ:"!=",LT:"<",LTE:"<=",GT:">",GTE:">="}[e.getFieldValue("OP")],t="=="==P||"!="==P?O.PHP.ORDER_EQUALITY:O.PHP.ORDER_RELATIONAL;return[(O.PHP.valueToCode(e,"A",t)||"0")+" "+P+" "+(e=O.PHP.valueToCode(e,"B",t)||"0"),t]},O.PHP.logic_operation=function(e){var P,t="AND"==e.getFieldValue("OP")?"&&":"||",r="&&"==t?O.PHP.ORDER_LOGICAL_AND:O.PHP.ORDER_LOGICAL_OR,n=O.PHP.valueToCode(e,"A",r);return e=O.PHP.valueToCode(e,"B",r),e=n||e?(P="&&"==t?"true":"false",n=n||P,e||P):n="false",[n+" "+t+" "+e,r]},O.PHP.logic_negate=function(e){var P=O.PHP.ORDER_LOGICAL_NOT;return["!"+(O.PHP.valueToCode(e,"BOOL",P)||"true"),P]},O.PHP.logic_boolean=function(e){return["TRUE"==e.getFieldValue("BOOL")?"true":"false",O.PHP.ORDER_ATOMIC]},O.PHP.logic_null=function(e){return["null",O.PHP.ORDER_ATOMIC]},O.PHP.logic_ternary=function(e){return[(O.PHP.valueToCode(e,"IF",O.PHP.ORDER_CONDITIONAL)||"false")+" ? "+(O.PHP.valueToCode(e,"THEN",O.PHP.ORDER_CONDITIONAL)||"null")+" : "+(e=O.PHP.valueToCode(e,"ELSE",O.PHP.ORDER_CONDITIONAL)||"null"),O.PHP.ORDER_CONDITIONAL]},O.PHP.loops={},O.PHP.controls_repeat_ext=function(e){var P=e.getField("TIMES")?String(Number(e.getFieldValue("TIMES"))):O.PHP.valueToCode(e,"TIMES",O.PHP.ORDER_ASSIGNMENT)||"0",t=O.PHP.statementToCode(e,"DO"),t=O.PHP.addLoopTrap(t,e);e="";var r=O.PHP.variableDB_.getDistinctName("count",O.VARIABLE_CATEGORY_NAME),n=P;return P.match(/^\w+$/)||O.isNumber(P)||(e+=(n=O.PHP.variableDB_.getDistinctName("repeat_end",O.VARIABLE_CATEGORY_NAME))+" = "+P+";\n"),e+"for ("+r+" = 0; "+r+" < "+n+"; "+r+"++) {\n"+t+"}\n"},O.PHP.controls_repeat=O.PHP.controls_repeat_ext,O.PHP.controls_whileUntil=function(e){var P="UNTIL"==e.getFieldValue("MODE"),t=O.PHP.valueToCode(e,"BOOL",P?O.PHP.ORDER_LOGICAL_NOT:O.PHP.ORDER_NONE)||"false",r=O.PHP.statementToCode(e,"DO");return P&&(t="!"+t),"while ("+t+") {\n"+(r=O.PHP.addLoopTrap(r,e))+"}\n"},O.PHP.controls_for=function(e){var P,t=O.PHP.variableDB_.getName(e.getFieldValue("VAR"),O.VARIABLE_CATEGORY_NAME),r=O.PHP.valueToCode(e,"FROM",O.PHP.ORDER_ASSIGNMENT)||"0",n=O.PHP.valueToCode(e,"TO",O.PHP.ORDER_ASSIGNMENT)||"0",_=O.PHP.valueToCode(e,"BY",O.PHP.ORDER_ASSIGNMENT)||"1",a=O.PHP.statementToCode(e,"DO"),a=O.PHP.addLoopTrap(a,e);return O.isNumber(r)&&O.isNumber(n)&&O.isNumber(_)?(e="for ("+t+" = "+r+"; "+t+((P=Number(r)<=Number(n))?" <= ":" >= ")+n+"; "+t,e=(1==(t=Math.abs(Number(_)))?e+(P?"++":"--"):e+(P?" += ":" -= ")+t)+") {\n"+a+"}\n"):(e="",(P=r).match(/^\w+$/)||O.isNumber(r)||(e+=(P=O.PHP.variableDB_.getDistinctName(t+"_start",O.VARIABLE_CATEGORY_NAME))+" = "+r+";\n"),(r=n).match(/^\w+$/)||O.isNumber(n)||(e+=(r=O.PHP.variableDB_.getDistinctName(t+"_end",O.VARIABLE_CATEGORY_NAME))+" = "+n+";\n"),e+=(n=O.PHP.variableDB_.getDistinctName(t+"_inc",O.VARIABLE_CATEGORY_NAME))+" = ",e=(e=O.isNumber(_)?e+(Math.abs(_)+";\n"):e+"abs("+_+");\n")+"if ("+P+" > "+r+") {\n"+(O.PHP.INDENT+n)+" = -"+n+";\n",e+="}\n",e+="for ("+t+" = "+P+"; "+n+" >= 0 ? "+t+" <= "+r+" : "+t+" >= "+r+"; "+t+" += "+n+") {\n"+a+"}\n"),e},O.PHP.controls_forEach=function(e){var P=O.PHP.variableDB_.getName(e.getFieldValue("VAR"),O.VARIABLE_CATEGORY_NAME),t=O.PHP.valueToCode(e,"LIST",O.PHP.ORDER_ASSIGNMENT)||"[]",r=O.PHP.statementToCode(e,"DO");return"foreach ("+t+" as "+P+") {\n"+(r=O.PHP.addLoopTrap(r,e))+"}\n"},O.PHP.controls_flow_statements=function(e){var P,t="";switch(O.PHP.STATEMENT_PREFIX&&(t+=O.PHP.injectId(O.PHP.STATEMENT_PREFIX,e)),O.PHP.STATEMENT_SUFFIX&&(t+=O.PHP.injectId(O.PHP.STATEMENT_SUFFIX,e)),!O.PHP.STATEMENT_PREFIX||(P=O.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN.getSurroundLoop(e))&&!P.suppressPrefixSuffix&&(t+=O.PHP.injectId(O.PHP.STATEMENT_PREFIX,P)),e.getFieldValue("FLOW")){case"BREAK":return t+"break;\n";case"CONTINUE":return t+"continue;\n"}throw Error("Unknown flow statement.")},O.PHP.math={},O.PHP.math_number=function(e){var P=0<=(e=Number(e.getFieldValue("NUM")))?O.PHP.ORDER_ATOMIC:O.PHP.ORDER_UNARY_NEGATION;return 1/0==e?e="INF":-1/0==e&&(e="-INF"),[e,P]},O.PHP.math_arithmetic=function(e){var P=(t={ADD:[" + ",O.PHP.ORDER_ADDITION],MINUS:[" - ",O.PHP.ORDER_SUBTRACTION],MULTIPLY:[" * ",O.PHP.ORDER_MULTIPLICATION],DIVIDE:[" / ",O.PHP.ORDER_DIVISION],POWER:[" ** ",O.PHP.ORDER_POWER]}[e.getFieldValue("OP")])[0],t=t[1];return[(O.PHP.valueToCode(e,"A",t)||"0")+P+(e=O.PHP.valueToCode(e,"B",t)||"0"),t]},O.PHP.math_single=function(e){var P=e.getFieldValue("OP");if("NEG"==P)return"-"==(e=O.PHP.valueToCode(e,"NUM",O.PHP.ORDER_UNARY_NEGATION)||"0")[0]&&(e=" "+e),["-"+e,O.PHP.ORDER_UNARY_NEGATION];switch(e="SIN"==P||"COS"==P||"TAN"==P?O.PHP.valueToCode(e,"NUM",O.PHP.ORDER_DIVISION)||"0":O.PHP.valueToCode(e,"NUM",O.PHP.ORDER_NONE)||"0",P){case"ABS":var t="abs("+e+")";break;case"ROOT":t="sqrt("+e+")";break;case"LN":t="log("+e+")";break;case"EXP":t="exp("+e+")";break;case"POW10":t="pow(10,"+e+")";break;case"ROUND":t="round("+e+")";break;case"ROUNDUP":t="ceil("+e+")";break;case"ROUNDDOWN":t="floor("+e+")";break;case"SIN":t="sin("+e+" / 180 * pi())";break;case"COS":t="cos("+e+" / 180 * pi())";break;case"TAN":t="tan("+e+" / 180 * pi())"}if(t)return[t,O.PHP.ORDER_FUNCTION_CALL];switch(P){case"LOG10":t="log("+e+") / log(10)";break;case"ASIN":t="asin("+e+") / pi() * 180";break;case"ACOS":t="acos("+e+") / pi() * 180";break;case"ATAN":t="atan("+e+") / pi() * 180";break;default:throw Error("Unknown math operator: "+P)}return[t,O.PHP.ORDER_DIVISION]},O.PHP.math_constant=function(e){return{PI:["M_PI",O.PHP.ORDER_ATOMIC],E:["M_E",O.PHP.ORDER_ATOMIC],GOLDEN_RATIO:["(1 + sqrt(5)) / 2",O.PHP.ORDER_DIVISION],SQRT2:["M_SQRT2",O.PHP.ORDER_ATOMIC],SQRT1_2:["M_SQRT1_2",O.PHP.ORDER_ATOMIC],INFINITY:["INF",O.PHP.ORDER_ATOMIC]}[e.getFieldValue("CONSTANT")]},O.PHP.math_number_property=function(e){var P=O.PHP.valueToCode(e,"NUMBER_TO_CHECK",O.PHP.ORDER_MODULUS)||"0",t=e.getFieldValue("PROPERTY");if("PRIME"==t)return[O.PHP.provideFunction_("math_isPrime",["function "+O.PHP.FUNCTION_NAME_PLACEHOLDER_+"($n) {","  // https://en.wikipedia.org/wiki/Primality_test#Naive_methods","  if ($n == 2 || $n == 3) {","    return true;","  }","  // False if n is NaN, negative, is 1, or not whole.","  // And false if n is divisible by 2 or 3.","  if (!is_numeric($n) || $n <= 1 || $n % 1 != 0 || $n % 2 == 0 || $n % 3 == 0) {","    return false;","  }","  // Check all the numbers of form 6k +/- 1, up to sqrt(n).","  for ($x = 6; $x <= sqrt($n) + 1; $x += 6) {","    if ($n % ($x - 1) == 0 || $n % ($x + 1) == 0) {","      return false;","    }","  }","  return true;","}"])+"("+P+")",O.PHP.ORDER_FUNCTION_CALL];switch(t){case"EVEN":var r=P+" % 2 == 0";break;case"ODD":r=P+" % 2 == 1";break;case"WHOLE":r="is_int("+P+")";break;case"POSITIVE":r=P+" > 0";break;case"NEGATIVE":r=P+" < 0";break;case"DIVISIBLE_BY":r=P+" % "+(e=O.PHP.valueToCode(e,"DIVISOR",O.PHP.ORDER_MODULUS)||"0")+" == 0"}return[r,O.PHP.ORDER_EQUALITY]},O.PHP.math_change=function(e){var P=O.PHP.valueToCode(e,"DELTA",O.PHP.ORDER_ADDITION)||"0";return O.PHP.variableDB_.getName(e.getFieldValue("VAR"),O.VARIABLE_CATEGORY_NAME)+" += "+P+";\n"},O.PHP.math_round=O.PHP.math_single,O.PHP.math_trig=O.PHP.math_single,O.PHP.math_on_list=function(e){var P=e.getFieldValue("OP");switch(P){case"SUM":e="array_sum("+(e=O.PHP.valueToCode(e,"LIST",O.PHP.ORDER_FUNCTION_CALL)||"array()")+")";break;case"MIN":e="min("+(e=O.PHP.valueToCode(e,"LIST",O.PHP.ORDER_FUNCTION_CALL)||"array()")+")";break;case"MAX":e="max("+(e=O.PHP.valueToCode(e,"LIST",O.PHP.ORDER_FUNCTION_CALL)||"array()")+")";break;case"AVERAGE":e=(P=O.PHP.provideFunction_("math_mean",["function "+O.PHP.FUNCTION_NAME_PLACEHOLDER_+"($myList) {","  return array_sum($myList) / count($myList);","}"]))+"("+(e=O.PHP.valueToCode(e,"LIST",O.PHP.ORDER_NONE)||"array()")+")";break;case"MEDIAN":e=(P=O.PHP.provideFunction_("math_median",["function "+O.PHP.FUNCTION_NAME_PLACEHOLDER_+"($arr) {","  sort($arr,SORT_NUMERIC);","  return (count($arr) % 2) ? $arr[floor(count($arr)/2)] : ","      ($arr[floor(count($arr)/2)] + $arr[floor(count($arr)/2) - 1]) / 2;","}"]))+"("+(e=O.PHP.valueToCode(e,"LIST",O.PHP.ORDER_NONE)||"[]")+")";break;case"MODE":e=(P=O.PHP.provideFunction_("math_modes",["function "+O.PHP.FUNCTION_NAME_PLACEHOLDER_+"($values) {","  if (empty($values)) return array();","  $counts = array_count_values($values);","  arsort($counts); // Sort counts in descending order","  $modes = array_keys($counts, current($counts), true);","  return $modes;","}"]))+"("+(e=O.PHP.valueToCode(e,"LIST",O.PHP.ORDER_NONE)||"[]")+")";break;case"STD_DEV":e=(P=O.PHP.provideFunction_("math_standard_deviation",["function "+O.PHP.FUNCTION_NAME_PLACEHOLDER_+"($numbers) {","  $n = count($numbers);","  if (!$n) return null;","  $mean = array_sum($numbers) / count($numbers);","  foreach($numbers as $key => $num) $devs[$key] = pow($num - $mean, 2);","  return sqrt(array_sum($devs) / (count($devs) - 1));","}"]))+"("+(e=O.PHP.valueToCode(e,"LIST",O.PHP.ORDER_NONE)||"[]")+")";break;case"RANDOM":e=(P=O.PHP.provideFunction_("math_random_list",["function "+O.PHP.FUNCTION_NAME_PLACEHOLDER_+"($list) {","  $x = rand(0, count($list)-1);","  return $list[$x];","}"]))+"("+(e=O.PHP.valueToCode(e,"LIST",O.PHP.ORDER_NONE)||"[]")+")";break;default:throw Error("Unknown operator: "+P)}return[e,O.PHP.ORDER_FUNCTION_CALL]},O.PHP.math_modulo=function(e){return[(O.PHP.valueToCode(e,"DIVIDEND",O.PHP.ORDER_MODULUS)||"0")+" % "+(e=O.PHP.valueToCode(e,"DIVISOR",O.PHP.ORDER_MODULUS)||"0"),O.PHP.ORDER_MODULUS]},O.PHP.math_constrain=function(e){return["min(max("+(O.PHP.valueToCode(e,"VALUE",O.PHP.ORDER_COMMA)||"0")+", "+(O.PHP.valueToCode(e,"LOW",O.PHP.ORDER_COMMA)||"0")+"), "+(e=O.PHP.valueToCode(e,"HIGH",O.PHP.ORDER_COMMA)||"Infinity")+")",O.PHP.ORDER_FUNCTION_CALL]},O.PHP.math_random_int=function(e){var P=O.PHP.valueToCode(e,"FROM",O.PHP.ORDER_COMMA)||"0";return e=O.PHP.valueToCode(e,"TO",O.PHP.ORDER_COMMA)||"0",[O.PHP.provideFunction_("math_random_int",["function "+O.PHP.FUNCTION_NAME_PLACEHOLDER_+"($a, $b) {","  if ($a > $b) {","    return rand($b, $a);","  }","  return rand($a, $b);","}"])+"("+P+", "+e+")",O.PHP.ORDER_FUNCTION_CALL]},O.PHP.math_random_float=function(e){return["(float)rand()/(float)getrandmax()",O.PHP.ORDER_FUNCTION_CALL]},O.PHP.math_atan2=function(e){var P=O.PHP.valueToCode(e,"X",O.PHP.ORDER_COMMA)||"0";return["atan2("+(O.PHP.valueToCode(e,"Y",O.PHP.ORDER_COMMA)||"0")+", "+P+") / pi() * 180",O.PHP.ORDER_DIVISION]},O.PHP.procedures={},O.PHP.procedures_defreturn=function(e){for(var P,t=[],r=e.workspace,n=O.Variables.allUsedVarModels(r)||[],_=0;P=n[_];_++)P=P.name,-1==e.getVars().indexOf(P)&&t.push(O.PHP.variableDB_.getName(P,O.VARIABLE_CATEGORY_NAME));for(n=O.Variables.allDeveloperVariables(r),_=0;_<n.length;_++)t.push(O.PHP.variableDB_.getName(n[_],O.Names.DEVELOPER_VARIABLE_TYPE));t=t.length?O.PHP.INDENT+"global "+t.join(", ")+";\n":"",r=O.PHP.variableDB_.getName(e.getFieldValue("NAME"),O.PROCEDURE_CATEGORY_NAME),P="",O.PHP.STATEMENT_PREFIX&&(P+=O.PHP.injectId(O.PHP.STATEMENT_PREFIX,e)),O.PHP.STATEMENT_SUFFIX&&(P+=O.PHP.injectId(O.PHP.STATEMENT_SUFFIX,e)),P=P&&O.PHP.prefixLines(P,O.PHP.INDENT);var a="";O.PHP.INFINITE_LOOP_TRAP&&(a=O.PHP.prefixLines(O.PHP.injectId(O.PHP.INFINITE_LOOP_TRAP,e),O.PHP.INDENT));for(var E=O.PHP.statementToCode(e,"STACK"),R=O.PHP.valueToCode(e,"RETURN",O.PHP.ORDER_NONE)||"",o=E&&R?P:"",R=R&&O.PHP.INDENT+"return "+R+";\n",i=[],n=e.getVars(),_=0;_<n.length;_++)i[_]=O.PHP.variableDB_.getName(n[_],O.VARIABLE_CATEGORY_NAME);return t="function "+r+"("+i.join(", ")+") {\n"+t+P+a+E+o+R+"}",t=O.PHP.scrub_(e,t),O.PHP.definitions_["%"+r]=t,null},O.PHP.procedures_defnoreturn=O.PHP.procedures_defreturn,O.PHP.procedures_callreturn=function(e){for(var P=O.PHP.variableDB_.getName(e.getFieldValue("NAME"),O.PROCEDURE_CATEGORY_NAME),t=[],r=e.getVars(),n=0;n<r.length;n++)t[n]=O.PHP.valueToCode(e,"ARG"+n,O.PHP.ORDER_COMMA)||"null";return[P+"("+t.join(", ")+")",O.PHP.ORDER_FUNCTION_CALL]},O.PHP.procedures_callnoreturn=function(e){return O.PHP.procedures_callreturn(e)[0]+";\n"},O.PHP.procedures_ifreturn=function(e){var P="if ("+(O.PHP.valueToCode(e,"CONDITION",O.PHP.ORDER_NONE)||"false")+") {\n";return O.PHP.STATEMENT_SUFFIX&&(P+=O.PHP.prefixLines(O.PHP.injectId(O.PHP.STATEMENT_SUFFIX,e),O.PHP.INDENT)),e.hasReturnValue_?(e=O.PHP.valueToCode(e,"VALUE",O.PHP.ORDER_NONE)||"null",P+=O.PHP.INDENT+"return "+e+";\n"):P+=O.PHP.INDENT+"return;\n",P+"}\n"},O.PHP.texts={},O.PHP.text=function(e){return[O.PHP.quote_(e.getFieldValue("TEXT")),O.PHP.ORDER_ATOMIC]},O.PHP.text_multiline=function(e){return[O.PHP.multiline_quote_(e.getFieldValue("TEXT")),O.PHP.ORDER_ATOMIC]},O.PHP.text_join=function(e){if(0==e.itemCount_)return["''",O.PHP.ORDER_ATOMIC];if(1==e.itemCount_)return[O.PHP.valueToCode(e,"ADD0",O.PHP.ORDER_NONE)||"''",O.PHP.ORDER_FUNCTION_CALL];if(2==e.itemCount_){var P=O.PHP.valueToCode(e,"ADD0",O.PHP.ORDER_ATOMIC)||"''";return[P+" . "+(e=O.PHP.valueToCode(e,"ADD1",O.PHP.ORDER_ATOMIC)||"''"),O.PHP.ORDER_STRING_CONCAT]}P=Array(e.itemCount_);for(var t=0;t<e.itemCount_;t++)P[t]=O.PHP.valueToCode(e,"ADD"+t,O.PHP.ORDER_COMMA)||"''";return[e="implode('', array("+P.join(",")+"))",O.PHP.ORDER_FUNCTION_CALL]},O.PHP.text_append=function(e){return O.PHP.variableDB_.getName(e.getFieldValue("VAR"),O.VARIABLE_CATEGORY_NAME)+" .= "+(e=O.PHP.valueToCode(e,"TEXT",O.PHP.ORDER_ASSIGNMENT)||"''")+";\n"},O.PHP.text_length=function(e){return[O.PHP.provideFunction_("length",["function "+O.PHP.FUNCTION_NAME_PLACEHOLDER_+"($value) {","  if (is_string($value)) {","    return strlen($value);","  } else {","    return count($value);","  }","}"])+"("+(e=O.PHP.valueToCode(e,"VALUE",O.PHP.ORDER_NONE)||"''")+")",O.PHP.ORDER_FUNCTION_CALL]},O.PHP.text_isEmpty=function(e){return["empty("+(O.PHP.valueToCode(e,"VALUE",O.PHP.ORDER_NONE)||"''")+")",O.PHP.ORDER_FUNCTION_CALL]},O.PHP.text_indexOf=function(e){var P,t="FIRST"==e.getFieldValue("END")?"strpos":"strrpos",r=O.PHP.valueToCode(e,"FIND",O.PHP.ORDER_NONE)||"''",n=O.PHP.valueToCode(e,"VALUE",O.PHP.ORDER_NONE)||"''",_=e.workspace.options.oneBasedIndex?(P=" 0"," + 1"):(P=" -1","");return[O.PHP.provideFunction_("FIRST"==e.getFieldValue("END")?"text_indexOf":"text_lastIndexOf",["function "+O.PHP.FUNCTION_NAME_PLACEHOLDER_+"($text, $search) {","  $pos = "+t+"($text, $search);","  return $pos === false ? "+P+" : $pos"+_+";","}"])+"("+n+", "+r+")",O.PHP.ORDER_FUNCTION_CALL]},O.PHP.text_charAt=function(e){var P=e.getFieldValue("WHERE")||"FROM_START",t=O.PHP.valueToCode(e,"VALUE","RANDOM"==P?O.PHP.ORDER_NONE:O.PHP.ORDER_COMMA)||"''";switch(P){case"FIRST":return["substr("+t+", 0, 1)",O.PHP.ORDER_FUNCTION_CALL];case"LAST":return["substr("+t+", -1)",O.PHP.ORDER_FUNCTION_CALL];case"FROM_START":return["substr("+t+", "+(e=O.PHP.getAdjusted(e,"AT"))+", 1)",O.PHP.ORDER_FUNCTION_CALL];case"FROM_END":return["substr("+t+", "+(e=O.PHP.getAdjusted(e,"AT",1,!0))+", 1)",O.PHP.ORDER_FUNCTION_CALL];case"RANDOM":return[O.PHP.provideFunction_("text_random_letter",["function "+O.PHP.FUNCTION_NAME_PLACEHOLDER_+"($text) {","  return $text[rand(0, strlen($text) - 1)];","}"])+"("+t+")",O.PHP.ORDER_FUNCTION_CALL]}throw Error("Unhandled option (text_charAt).")},O.PHP.text_getSubstring=function(e){var P,t=O.PHP.valueToCode(e,"STRING",O.PHP.ORDER_FUNCTION_CALL)||"''",r=e.getFieldValue("WHERE1"),n=e.getFieldValue("WHERE2");return"FIRST"==r&&"LAST"==n||(P=O.PHP.getAdjusted(e,"AT1"),e=O.PHP.getAdjusted(e,"AT2"),t=O.PHP.provideFunction_("text_get_substring",["function "+O.PHP.FUNCTION_NAME_PLACEHOLDER_+"($text, $where1, $at1, $where2, $at2) {","  if ($where1 == 'FROM_END') {","    $at1 = strlen($text) - 1 - $at1;","  } else if ($where1 == 'FIRST') {","    $at1 = 0;","  } else if ($where1 != 'FROM_START') {","    throw new Exception('Unhandled option (text_get_substring).');","  }","  $length = 0;","  if ($where2 == 'FROM_START') {","    $length = $at2 - $at1 + 1;","  } else if ($where2 == 'FROM_END') {","    $length = strlen($text) - $at1 - $at2;","  } else if ($where2 == 'LAST') {","    $length = strlen($text) - $at1;","  } else {","    throw new Exception('Unhandled option (text_get_substring).');","  }","  return substr($text, $at1, $length);","}"])+"("+t+", '"+r+"', "+P+", '"+n+"', "+e+")"),[t,O.PHP.ORDER_FUNCTION_CALL]},O.PHP.text_changeCase=function(e){var P,t=O.PHP.valueToCode(e,"TEXT",O.PHP.ORDER_NONE)||"''";return"UPPERCASE"==e.getFieldValue("CASE")?P="strtoupper("+t+")":"LOWERCASE"==e.getFieldValue("CASE")?P="strtolower("+t+")":"TITLECASE"==e.getFieldValue("CASE")&&(P="ucwords(strtolower("+t+"))"),[P,O.PHP.ORDER_FUNCTION_CALL]},O.PHP.text_trim=function(e){return[{LEFT:"ltrim",RIGHT:"rtrim",BOTH:"trim"}[e.getFieldValue("MODE")]+"("+(e=O.PHP.valueToCode(e,"TEXT",O.PHP.ORDER_NONE)||"''")+")",O.PHP.ORDER_FUNCTION_CALL]},O.PHP.text_print=function(e){return"print("+(O.PHP.valueToCode(e,"TEXT",O.PHP.ORDER_NONE)||"''")+");\n"},O.PHP.text_prompt_ext=function(e){var P="readline("+(e.getField("TEXT")?O.PHP.quote_(e.getFieldValue("TEXT")):O.PHP.valueToCode(e,"TEXT",O.PHP.ORDER_NONE)||"''")+")";return"NUMBER"==e.getFieldValue("TYPE")&&(P="floatval("+P+")"),[P,O.PHP.ORDER_FUNCTION_CALL]},O.PHP.text_prompt=O.PHP.text_prompt_ext,O.PHP.text_count=function(e){var P=O.PHP.valueToCode(e,"TEXT",O.PHP.ORDER_MEMBER)||"''";return["strlen("+(e=O.PHP.valueToCode(e,"SUB",O.PHP.ORDER_NONE)||"''")+") === 0 ? strlen("+P+") + 1 : substr_count("+P+", "+e+")",O.PHP.ORDER_CONDITIONAL]},O.PHP.text_replace=function(e){var P=O.PHP.valueToCode(e,"TEXT",O.PHP.ORDER_MEMBER)||"''";return["str_replace("+(O.PHP.valueToCode(e,"FROM",O.PHP.ORDER_NONE)||"''")+", "+(e=O.PHP.valueToCode(e,"TO",O.PHP.ORDER_NONE)||"''")+", "+P+")",O.PHP.ORDER_FUNCTION_CALL]},O.PHP.text_reverse=function(e){return["strrev("+(O.PHP.valueToCode(e,"TEXT",O.PHP.ORDER_MEMBER)||"''")+")",O.PHP.ORDER_FUNCTION_CALL]},O.PHP.variables={},O.PHP.variables_get=function(e){return[O.PHP.variableDB_.getName(e.getFieldValue("VAR"),O.VARIABLE_CATEGORY_NAME),O.PHP.ORDER_ATOMIC]},O.PHP.variables_set=function(e){var P=O.PHP.valueToCode(e,"VALUE",O.PHP.ORDER_ASSIGNMENT)||"0";return O.PHP.variableDB_.getName(e.getFieldValue("VAR"),O.VARIABLE_CATEGORY_NAME)+" = "+P+";\n"},O.PHP.variablesDynamic={},O.PHP.variables_get_dynamic=O.PHP.variables_get,O.PHP.variables_set_dynamic=O.PHP.variables_set,O.PHP});